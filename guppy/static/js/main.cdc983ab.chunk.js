(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{114:function(e,t,n){e.exports=n(297)},288:function(e,t,n){},297:function(e,t,n){"use strict";n.r(t);var a=n(16),r=n(17),s=n(19),o=n(18),i=n(20),l=n(1),c=n(110),h=n.n(c),p=n(0),u=n.n(p),_=n(42),g=n.n(_),f=n(111),m=n.n(f),d=(n(288),n(112)),y=n.n(d),x=(n(295),n(296),n(65));var b=n.e(3).then(n.bind(null,299)),v=function(e){function t(e,n){var r;return Object(a.a)(this,t),(r=Object(s.a)(this,Object(o.a)(t).call(this,e,n))).onChange=r.onChange.bind(Object(l.a)(Object(l.a)(r))),r.Execute=r.Execute.bind(Object(l.a)(Object(l.a)(r))),r.PauseResume=r.PauseResume.bind(Object(l.a)(Object(l.a)(r))),r.onResize=r.onResize.bind(Object(l.a)(Object(l.a)(r))),r.setText=r.setText.bind(Object(l.a)(Object(l.a)(r))),r.setClocks=r.setClocks.bind(Object(l.a)(Object(l.a)(r))),r.state={clocks:0},r}return Object(i.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.props.glContainer.on("resize",this.onResize),this.props.globals().setText=this.setText,this.props.globals().setClocks=this.setClocks}},{key:"onChange",value:function(e){this.text=e}},{key:"onResize",value:function(){}},{key:"PauseResume",value:function(){this.props.globals().wasm&&(this.props.globals().run=!this.props.globals().run)}},{key:"setClocks",value:function(e){this.setState({clocks:e})}},{key:"setText",value:function(e){this.refs.editor.editor.setValue(e)}},{key:"Execute",value:function(){var e=this.props.globals();if(this.props.globals().wasm){this.props.globals().resetGPU();for(var t=this.props.globals().dispatchConfig,n=0;n<e.r_images.length;n++)e.wasm.guppy_put_image(e.r_images[n]);this.props.globals().wasm.guppy_dispatch(this.text,t.group_size,t.groups_count),this.props.globals().run=!0}else console.log("[WARNING] wasm in null")}},{key:"render",value:function(){return u.a.createElement("div",{className:"ace_editor_container"},u.a.createElement("button",{style:{margin:10},onClick:this.Execute},"Execute"),u.a.createElement("button",{style:{margin:10},onClick:this.PauseResume},"Pause/Resume Clocks:",this.state.clocks),u.a.createElement("div",{style:{background:"#cccccc",margin:10}},u.a.createElement("p",{style:{margin:5}},"Setup example"),u.a.createElement("button",{style:{border:1},onClick:this.props.globals().setupRaymarching},"RayMarching"),u.a.createElement("button",{style:{border:1},onClick:this.props.globals().setupBranch_1},"branch_1"),u.a.createElement("button",{style:{border:1},onClick:this.props.globals().setupBranch_2},"branch_2"),u.a.createElement("button",{style:{border:1},onClick:this.props.globals().setupBranch_3},"branch_3"),u.a.createElement("button",{style:{border:1},onClick:this.props.globals().setupBranch_4},"branch_4"),u.a.createElement("button",{style:{border:1},onClick:this.props.globals().setupBranch_5},"branch_5"),u.a.createElement("button",{style:{border:1},onClick:this.props.globals().setupBranch_6},"branch_6")),u.a.createElement(y.a,{value:this.text,ref:"editor",mode:"assembly_x86",theme:"tomorrow_night_eighties",onChange:this.onChange,name:"UNIQUE_ID_OF_DIV",editorProps:{$blockScrolling:!0},autoScrollEditorIntoView:!1,wrapEnabled:!1,height:"700px",width:"512px"}))}}]),t}(u.a.Component),w=function(e){function t(e,n){var r;return Object(a.a)(this,t),(r=Object(s.a)(this,Object(o.a)(t).call(this,e,n))).onChange=r.onChange.bind(Object(l.a)(Object(l.a)(r))),r.onChangeDispatch=r.onChangeDispatch.bind(Object(l.a)(Object(l.a)(r))),r.updateParameters=r.updateParameters.bind(Object(l.a)(Object(l.a)(r))),r}return Object(i.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.props.globals().updateParameters=this.updateParameters}},{key:"onChange",value:function(e,t,n,a){console.log("onchange",e,t),this.props.globals().gpuConfig[e]=t}},{key:"onChangeDispatch",value:function(e,t,n,a){console.log("onChangeDispatch",e,t),this.props.globals().dispatchConfig[e]=t}},{key:"updateParameters",value:function(){this.refs.gpu_config.setState({data:{root:this.props.globals().gpuConfig}}),this.refs.dispatch_config.setState({data:{root:this.props.globals().dispatchConfig}})}},{key:"render",value:function(){return u.a.createElement("div",null,u.a.createElement("p",{style:{color:"white",margin:10}},"GPU Config"),u.a.createElement(x.JSONEditor,{ref:"gpu_config",data:this.props.globals().gpuConfig,onChange:this.onChange}),u.a.createElement("p",{style:{color:"white",margin:10}},"Dispatch config"),u.a.createElement(x.JSONEditor,{ref:"dispatch_config",data:this.props.globals().dispatchConfig,onChange:this.onChangeDispatch}))}}]),t}(u.a.Component),z=function(e){function t(e,n){return Object(a.a)(this,t),Object(s.a)(this,Object(o.a)(t).call(this,e,n))}return Object(i.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return u.a.createElement(m.a,{className:"Markdown",source:"# Toy GPU performace simulator\n* One\n* Two\n  * Three\n___\n```console\n$ kill me\n```"})}}]),t}(u.a.Component),k=function(e){function t(e,n){var r;return Object(a.a)(this,t),(r=Object(s.a)(this,Object(o.a)(t).call(this,e,n))).updateMemory=r.updateMemory.bind(Object(l.a)(Object(l.a)(r))),r}return Object(i.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.globals().updateMemory=this.updateMemory,this.ctx=this.refs.canvas.getContext("2d");var t=function(e){return new Promise(function(t){e.onload=function(){t({img:e,status:"ok"})},e.onerror=function(){return t({img:e,status:"error"})}})},n=this.refs.t0,a=this.refs.t1,r=this.refs.t4;Promise.all([t(n),t(a),t(r)]).then(function(t){var s=function(t){e.refs.canvas.width=t.width,e.refs.canvas.height=t.height,e.ctx.drawImage(t,0,0);var n=e.ctx.getImageData(0,0,1,1).data;("000000"+function(e,t,n){if(e>255||t>255||n>255)throw"Invalid color component";return(e<<16|t<<8|n).toString(16)}(n[0],n[1],n[2])).slice(-6);var a=e.refs.canvas.toDataURL("image/png");e.props.globals().r_images.push(a)};s(n),s(a);var o=function(t){e.refs.canvas.width=256,e.refs.canvas.height=256;for(var n=0;n<256;n++)for(var a=0;a<256;a++)e.ctx.fillStyle="#ffffff",Math.floor(a/t)%2==0^Math.floor(n/t)%2==0&&(e.ctx.fillStyle="#000000"),e.ctx.fillRect(a,n,1,1);var r=e.refs.canvas.toDataURL("image/png");e.props.globals().r_images.push(r);var s=new Image;return s.src=r,s};e.checkerboard1=o(1),e.checkerboard64=o(64),s(r),e.props.globals().resetGPU(),e.updateMemory()})}},{key:"updateMemory",value:function(){var e=this.refs.canvas.getContext("2d"),t=new Image,n=this.refs.canvas,a=this.props.globals(),r=this.refs.t0,s=this.refs.t1,o=this.checkerboard1,i=this.checkerboard64,l=this.refs.t4;t.onload=function(){n.width=512,n.height=1536,e.fillStyle="#222222",e.fillRect(0,0,n.width,n.height);var a=0,c=5,h=function(t){e.font="14px Monaco, monospace",e.textAlign="start",e.textBaseline="top",e.fillStyle="#ffffff",e.fillText(t,a,c),a+=8*t.length};h("s0 = Sampler {WrapMode::WRAP, SampleMode::BILINEAR}"),c+=16,a=0,h("t0 = "),e.drawImage(r,a,c),c+=r.height+10,a=0,h("t1 = "),e.drawImage(s,a,c),c+=s.height+10,a=0,h("t2 = "),e.drawImage(o,a,c),c+=o.height+10,a=0,h("t3 = "),e.drawImage(i,a,c),c+=i.height+10,a=0,h("t4 = "),e.drawImage(l,a,c),c+=l.height+10,a=0,h("u0 = "),e.drawImage(t,a,c)};var c="data:image/png;base64,"+a.wasm.guppy_get_image(0,!1);t.src=c}},{key:"render",value:function(){return u.a.createElement("div",null,u.a.createElement("canvas",{ref:"canvas"}),u.a.createElement("img",{style:{display:"none"},ref:"t0",src:"img/lenna.png"}),u.a.createElement("img",{style:{display:"none"},ref:"t1",src:"img/rhino.png"}),u.a.createElement("img",{style:{display:"none"},ref:"t4",src:"img/noise.png"}))}}]),t}(u.a.Component),C=function(e){function t(e,n){var r;return Object(a.a)(this,t),(r=Object(s.a)(this,Object(o.a)(t).call(this,e,n))).neededWidth=4096,r.neededHeight=1024,r.updateCanvas=r.updateCanvas.bind(Object(l.a)(Object(l.a)(r))),r.onResize=r.onResize.bind(Object(l.a)(Object(l.a)(r))),r.scheduleDraw=r.scheduleDraw.bind(Object(l.a)(Object(l.a)(r))),r.remapColors=r.remapColors.bind(Object(l.a)(Object(l.a)(r))),r.colorMap={},r.getRandomColor=function(){for(var e="#",t=0;t<6;t++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e},r}return Object(i.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.draw=!0,this.ctx=this.refs.canvas.getContext("2d"),this.canvas=this.refs.canvas,this.lastClock=0,this.props.glContainer.on("resize",this.onResize),this.globals=this.props.globals,this.globals().updateCanvas=this.scheduleDraw,this.updateCanvas()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateCanvas)}},{key:"onResize",value:function(){this.updateCanvas()}},{key:"scheduleDraw",value:function(){this.draw=!0,this.updateCanvas()}},{key:"remapColors",value:function(){for(var e=this.globals().gpuConfig.waves_per_cu,t=0;t<e;t++)this.colorMap[t]=this.getRandomColor();this.draw=!0,this.updateCanvas()}},{key:"updateCanvas",value:function(){var e=this;if(this.draw){var t=this.globals().gpuConfig.wave_size,n=this.globals().gpuConfig.waves_per_cu,a=this.globals().gpuConfig.CU_count,r=this.globals().gpuConfig.ALU_per_cu;this.globals().gpuConfig.ALU_pipe_len;this.globals().active_mask_history&&(this.neededWidth=this.globals().active_mask_history.length+512,this.neededHeight=(t+4+4*r+14)*this.globals().gpuConfig.CU_count*this.globals().gpuConfig.waves_per_cu+1536),this.draw=!1,this.canvas.width=this.neededWidth,this.canvas.height=this.neededHeight,this.ctx.fillStyle="#222222",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height);for(var s=0,o=0,i=function(t,n,a){var r=e.ctx;r.font="10px Monaco, monospace",r.textAlign="start",r.textBaseline="top",r.fillStyle="#ffffff",r.fillText(t,n,a)},l={0:"inactive",1:"active",2:"disabled",3:"stalled",4:"idle"},c={0:"black",1:"white",2:"grey",3:"blue",4:"red"},h=this.ctx,p=0;p<5;p++)this.ctx.fillStyle=c[p],this.ctx.fillRect(s,o,16,16),h.font="24px Monaco, monospace",h.textAlign="start",h.textBaseline="top",h.fillStyle="#ffffff",h.fillText(l[p],s+16,o),o+=22;if(this.globals().active_mask_history){var u=Array(a).fill(0);for(p=0;p<this.globals().sampler_cache_history.length;p++)for(var _=this.globals().sampler_cache_history[p],g=0;g<a;g++)u[g]=Math.max(u[g],_[3*g+0],_[3*g+1],_[3*g+2]);var f=this.globals().active_mask_history;if(f.length>0){i("cycles:"+this.globals().clocks,0,o);var h=this.ctx;s=48;var m=o+16;for(p=0;p<f.length;p++){this.neededHeight=Math.max(this.neededHeight,o),o=m+4;for(var d=0;d<a;d++){o+=8,0==p&&i("core#"+d,0,o),o+=12;for(var y=0;y<n;y++){0==p&&(i("wave#"+y,0,o+t/2),y in this.colorMap||(this.colorMap[y]=this.getRandomColor()),this.ctx.fillStyle=this.colorMap[y],this.ctx.fillRect(38,o+t/2,4,4));for(var x=0;x<t;x++){var b=d*n*t+y*t+x;b%t==0&&(o+=4),this.ctx.fillStyle=c[f[p][b]],this.ctx.fillRect(s,o,1,1),o+=1}}o+=4;for(var v=this.globals().alu_active_history,w=0;w<r;w++){0==p&&i("ALU#"+w,0,o);var z=d*r+w;-1==v[p][z]?this.ctx.fillStyle="white":-2==v[p][z]?this.ctx.fillStyle="black":this.ctx.fillStyle=this.colorMap[v[p][z]],this.ctx.fillRect(s,o,1,6),o+=14}o+=4;var k=this.globals().sampler_cache_history,C=10*k[p][3*d+0]/u[d],O=10*k[p][3*d+1]/u[d],L=10*k[p][3*d+2]/u[d];0==p&&i("sampler",0,o);for(g=10;g>=0;g--){var R=0,j=0,E=0;g<=C&&(R=255),g<=O&&(j=255),g<=L&&(E=255),this.ctx.fillStyle="rgb("+Math.floor(R)+", "+Math.floor(j)+", "+Math.floor(E)+")",this.ctx.fillRect(s,o,1,1),o+=1}}s+=1,this.neededWidth=Math.max(this.neededWidth,s)}}}(h=this.ctx).font="14px Monaco, monospace";var B="(r, g, b) = (hits, misses, evictions)";if(h.textAlign="start",h.textBaseline="top",h.fillStyle="#ffffff",h.fillText(B,0,o+16),o+=16,this.globals().l2_metric_history){var M=this.globals().l2_metric_history;if(M.length>0){(h=this.ctx).font="14px Monaco, monospace";B="L2$";h.textAlign="start",h.textBaseline="top",h.fillStyle="#ffffff",h.fillText(B,0,o+16);m=o+32;s=48;var P=0;for(p=0;p<M.length;p++)P=Math.max(P,M[p][0],M[p][1],M[p][2]);for(p=0;p<M.length;p++){this.neededHeight=Math.max(this.neededHeight,o),o=m;var D=100*M[p][0]/P,S=100*M[p][1]/P,A=100*M[p][2]/P;for(g=100;g>=0;g--){R=0,j=0,E=0;g<=D&&(R=255),g<=S&&(j=255),g<=A&&(E=255),this.ctx.fillStyle="rgb("+Math.floor(R)+", "+Math.floor(j)+", "+Math.floor(E)+")",this.ctx.fillRect(s,o,1,1),o+=1}s+=1}this.neededWidth=Math.max(this.neededWidth,s)}}}}},{key:"render",value:function(){return u.a.createElement("div",null,u.a.createElement("div",{style:{marginLeft:0,marginRight:"40%"}},u.a.createElement("button",{onClick:this.scheduleDraw},"Render History"),u.a.createElement("button",{onClick:this.remapColors},"Shuffle Colors")),u.a.createElement("canvas",{ref:"canvas"})," ")}}]),t}(u.a.Component),O=function(e){function t(e,n){var r;return Object(a.a)(this,t),(r=Object(s.a)(this,Object(o.a)(t).call(this,e,n))).setupRaymarching=r.setupRaymarching.bind(Object(l.a)(Object(l.a)(r))),r.setupBranch_1=r.setupBranch_1.bind(Object(l.a)(Object(l.a)(r))),r.setupBranch_2=r.setupBranch_2.bind(Object(l.a)(Object(l.a)(r))),r.setupBranch_3=r.setupBranch_3.bind(Object(l.a)(Object(l.a)(r))),r.setupBranch_4=r.setupBranch_4.bind(Object(l.a)(Object(l.a)(r))),r.setupBranch_5=r.setupBranch_5.bind(Object(l.a)(Object(l.a)(r))),r.setupBranch_6=r.setupBranch_6.bind(Object(l.a)(Object(l.a)(r))),r}return Object(i.a)(t,e),Object(r.a)(t,[{key:"setupRaymarching",value:function(){this.globals.dispatchConfig={group_size:32,groups_count:2048,cycles_per_iter:1,"update graph":!1},this.globals.gpuConfig={DRAM_latency:32,DRAM_bandwidth:768,L1_size:1024,L1_latency:4,L2_size:1024,L2_latency:16,sampler_cache_size:1024,sampler_latency:16,VGPRF_per_pe:128,wave_size:32,CU_count:2,ALU_per_cu:2,waves_per_cu:4,fd_per_cu:2,ALU_pipe_len:1},this.globals.setText("jmp ENTRY\n\n; Distance function\n; In   : r32.xyz\n; Uses : r33.xyzw, r32.xyzw\n; Out  : r32.w\nDIST_FN:\n\n; Sphere_0\nsub.f32 r33.xyz, r32.xyz, f3(0.0 0.0 5.0)\nlen r33.w, r33.xyz\nsub.f32 r33.w, r33.w, f(9.0)\n\n; Sphere_1\nsub.f32 r34.xyz, r32.xyz, f3(0.0 0.0 -5.0)\nlen r34.w, r34.xyz\nsub.f32 r34.w, r34.w, f(5.0)\n\n; Smooth min\nsub.f32 r34.x, r33.w, r34.w\nmul.f32 r34.x, r34.x, f(0.2)\nmad.f32 r34.x, r34.x, f(0.5), f(0.5)\nclamp r34.x, r34.x\n; mul.f32 r34.x, r34.x, r34.x\nlerp r32.w, r34.w, r33.w, r34.x\n\nsub.f32 r34.w, r34.x, f(1.0)\nmul.f32 r34.w, r34.w, f(5.)\nmad.f32 r32.w, r34.x, r34.w, r32.w\n\n\npop_mask\n\nENTRY:\n; Figure out where we are in the screen space\nmov r0.xy, thread_id\nand r0.x, r0.x, u(255)\ndiv.u32 r0.y, r0.y, u(256)\nmov r0.zw, r0.xy\n\n; put the red color as an indiacation of ongoing work\nst u0.xyzw, r0.zw, f4(1.0 0.0 0.0 1.0)\n\n; Normalize screen coordiantes\nutof r0.xy, r0.xy\n; add 0.5 to fit the center of the texel\nadd.f32 r0.xy, r0.xy, f2(0.5 0.5)\n; normalize coordinates\ndiv.f32 r0.xy, r0.xy, f2(256.0 256.0)\n; tx * 2.0 - 1.0\nmul.f32 r0.xy, r0.xy, f2(2.0 -2.0)\nsub.f32 r0.xy, r0.xy, f2(1.0 -1.0)\n\n; Setup a simple pinhole camera\n; Camera position\nmov r1.xyz, f3(10.0 10.0 0.0)\n; Camera look vector\nmov r2.xyz, f3(-0.7071 -0.7071 0.0)\n; Camera right vector\nmov r3.xyz, f3(-0.7071 0.7071 0.0)\n; Camera up vector\nmov r4.xyz, f3(0.0 0.0 1.0)\n; Setup ray direction\nmov r5.xyz, r2.xyz\nmad.f32 r5.xyz, r0.xxx, r3.xyz, r5.xyz\nmad.f32 r5.xyz, r0.yyy, r4.xyz, r5.xyz\nnorm r5.xyz, r5.xyz\n\n; Now solve the scene\n\nmov r15.xyz, r5.xyz\nmul.f32 r15.xyz, r15.xyz, f3(0.01 0.01 0.01)\nadd.f32 r15.xyz, r15.xyz, r1.xyz\n\n;jmp LOOP_END\n\npush_mask LOOP_END\nLOOP_BEGIN:\n; if (r16.y < 16)\nlt.u32 r16.x, r16.y, u(16)\nmask_nz r16.x\n; Loop body begin\nmov r32.xyz, r15.xyz\npush_mask RET\njmp DIST_FN\nRET:\ngt.f32 r14.x, r32.w, f(0.001)\nsub.u32 r13.x, u(1), r14.x\nutof r13.x, r13.x\nmask_nz r14.x\nmad.f32 r15.xyz, r5.xyz, r32.www, r15.xyz\n\n; Loop body end\n; Increment iteration counter\nadd.u32 r16.y, r16.y, u(1)\n\njmp LOOP_BEGIN\n\nLOOP_END:\n\nmov r10.w, f(1.0)\nabs.f32 r10.xyz, r5.www\n\npush_mask L1\nmask_nz r13.x\nnorm r15.xyz, r15.xyz\nsample r10.xyzw, t0.xyzw, s0, r15.xy\npop_mask\nL1:\n; mov r5.xyz, r32.www\n; mov r16.y, u(1)\n; utof r14.x, r16.y\n; div.f32 r14.x, r14.x, f(4.0)\n\nst u0.xyzw, r0.zw, r10.xyzw\nret"),this.globals.resetGPU()}},{key:"setupBranch_5",value:function(){this.globals.dispatchConfig={group_size:32,groups_count:2048,cycles_per_iter:1,"update graph":!0},this.globals.gpuConfig={DRAM_latency:32,DRAM_bandwidth:768,L1_size:1024,L1_latency:4,L2_size:1024,L2_latency:16,sampler_cache_size:1024,sampler_latency:16,VGPRF_per_pe:128,wave_size:32,CU_count:4,ALU_per_cu:2,waves_per_cu:4,fd_per_cu:2,ALU_pipe_len:1},this.globals.setText("; Figure out where we are in the screen space\nmov r0.xy, thread_id\nand r0.x, r0.x, u(255)\ndiv.u32 r0.y, r0.y, u(256)\nmov r0.zw, r0.xy\n\n; put the red color as an indiacation of ongoing work\nst u0.xyzw, r0.zw, f4(1.0 0.0 0.0 1.0)\n\n; Normalize screen coordiantes\nutof r0.xy, r0.xy\n; add 0.5 to fit the center of the texel\nadd.f32 r0.xy, r0.xy, f2(0.5 0.5)\n; normalize coordinates\ndiv.f32 r0.xy, r0.xy, f2(256.0 256.0)\n\nsample r10.xyzw, t0.xyzw, s0, r0.xy\nsample r11.xyzw, t1.xyzw, s0, r0.xy\nsample r12.xyzw, t2.xyzw, s0, r0.xy\n\nlerp r10.xyzw, r10.xyzw, r11.xyzw, r12.x\n\nst u0.xyzw, r0.zw, r10.xyzw\nret"),this.globals.resetGPU()}},{key:"setupBranch_6",value:function(){this.globals.dispatchConfig={group_size:32,groups_count:2048,cycles_per_iter:1,"update graph":!1},this.globals.gpuConfig={DRAM_latency:32,DRAM_bandwidth:768,L1_size:1024,L1_latency:4,L2_size:1024,L2_latency:16,sampler_cache_size:1024,sampler_latency:16,VGPRF_per_pe:128,wave_size:32,CU_count:64,ALU_per_cu:2,waves_per_cu:4,fd_per_cu:2,ALU_pipe_len:1},this.globals.setText("; Figure out where we are in the screen space\nmov r0.xy, thread_id\nand r0.x, r0.x, u(255)\ndiv.u32 r0.y, r0.y, u(256)\nmov r0.zw, r0.xy\n\n; put the red color as an indiacation of ongoing work\nst u0.xyzw, r0.zw, f4(1.0 0.0 0.0 1.0)\n\n; Normalize screen coordiantes\nutof r0.xy, r0.xy\n; add 0.5 to fit the center of the texel\nadd.f32 r0.xy, r0.xy, f2(0.5 0.5)\n; normalize coordinates\ndiv.f32 r0.xy, r0.xy, f2(256.0 256.0)\n\nsample r12.xyzw, t4.xyzw, s0, r0.xy\n\nmov r32.w, f(1.0)\n\npush_mask SKIP_S1\ngt.f32 r15.x, r12.x, f(0.0)\nmask_nz r15.x\nmov r32.y, f(1.0)\nst u0.xyzw, r0.zw, r32.xyzw\nsample r10.xyzw, t0.xyzw, s0, r0.xy\npop_mask\n\nSKIP_S1:\n\npush_mask SKIP_S2\nlt.f32 r16.x, r12.x, f(1.0)\nmask_nz r16.x\nmov r32.z, f(1.0)\nst u0.xyzw, r0.zw, r32.xyzw\nsample r11.xyzw, t1.xyzw, s0, r0.xy\npop_mask\n\nSKIP_S2:\n\n\nlerp r10.xyzw, r10.xyzw, r11.xyzw, r12.xxxx\n\nmov r10.x, clock\nutof r10.x, r10.x\ndiv.f32 r10.x, r10.x, f(120.0)\nmov r10.yz, f2(0.0 0.0)\nst u0.xyzw, r0.zw, r10.xxxw\nret"),this.globals.resetGPU()}},{key:"setupBranch_1",value:function(){this.globals.dispatchConfig={group_size:32,groups_count:1,cycles_per_iter:1,"update graph":!0},this.globals.gpuConfig={DRAM_latency:32,DRAM_bandwidth:768,L1_size:1024,L1_latency:4,L2_size:1024,L2_latency:16,sampler_cache_size:1024,sampler_latency:16,VGPRF_per_pe:128,wave_size:32,CU_count:1,ALU_per_cu:1,waves_per_cu:1,fd_per_cu:1,ALU_pipe_len:1},this.globals.setText("; uint lane_id = get_lane_id();\n    mov r0.x, lane_id\n; if (lane_id & 1) {\n    push_mask BRANCH_END\n    and r0.y, r0.x, u(1)\n    mask_nz r0.y\nLOOP_BEGIN:\n    ; // Do smth\n     mov r0.x, r0.x\n     mov r0.x, r0.x\n     mov r0.x, r0.x\n     mov r0.x, r0.x\n     mov r0.x, r0.x\n     \n    pop_mask                ; pop mask and reconverge\nBRANCH_END:\n    ; // Do some more\n    ret"),this.globals.resetGPU()}},{key:"setupBranch_2",value:function(){this.globals.dispatchConfig={group_size:32,groups_count:1,cycles_per_iter:1,"update graph":!0},this.globals.gpuConfig={DRAM_latency:32,DRAM_bandwidth:768,L1_size:1024,L1_latency:4,L2_size:1024,L2_latency:16,sampler_cache_size:1024,sampler_latency:16,VGPRF_per_pe:128,wave_size:32,CU_count:1,ALU_per_cu:1,waves_per_cu:1,fd_per_cu:1,ALU_pipe_len:1},this.globals.setText("; uint lane_id = get_lane_id();\n    mov r0.x, lane_id\n; for (uint i = lane_id; i < 16; i++) {\n    push_mask LOOP_END\nLOOP_PROLOG:\n    lt.u32 r0.y, r0.x, u(16)\n    add.u32 r0.x, r0.x, u(1)\n    mask_nz r0.y\nLOOP_BEGIN:\n    ; // Do smth\n    jmp LOOP_PROLOG\nLOOP_END:\n    ; // }\n    ret"),this.globals.resetGPU()}},{key:"setupBranch_3",value:function(){this.globals.dispatchConfig={group_size:32,groups_count:1,cycles_per_iter:1,"update graph":!0},this.globals.gpuConfig={DRAM_latency:32,DRAM_bandwidth:768,L1_size:1024,L1_latency:4,L2_size:1024,L2_latency:16,sampler_cache_size:1024,sampler_latency:16,VGPRF_per_pe:128,wave_size:32,CU_count:1,ALU_per_cu:1,waves_per_cu:1,fd_per_cu:1,ALU_pipe_len:1},this.globals.setText("    mov r0.x, lane_id\n    lt.u32 r0.y, r0.x, u(16)\n    ; if (lane_id > 16) {\n    br_push r0.y, ELSE, CONVERGE\nTHEN:\n    ; // Do smth\n    mov r0.x, r0.x\n    mov r0.x, r0.x\n    mov r0.x, r0.x\n    mov r0.x, r0.x\n    mov r0.x, r0.x\n\n    pop_mask\n\n    ; } else {\nELSE:\n    ; // Do smth else\n    mov r0.x, r0.x\n    mov r0.x, r0.x\n    mov r0.x, r0.x\n    mov r0.x, r0.x\n    mov r0.x, r0.x\n\n    pop_mask\n    ; }\nCONVERGE:\n    ret"),this.globals.resetGPU()}},{key:"setupBranch_4",value:function(){this.globals.dispatchConfig={group_size:32,groups_count:1,cycles_per_iter:1,"update graph":!0},this.globals.gpuConfig={DRAM_latency:32,DRAM_bandwidth:768,L1_size:1024,L1_latency:4,L2_size:1024,L2_latency:16,sampler_cache_size:1024,sampler_latency:16,VGPRF_per_pe:128,wave_size:32,CU_count:1,ALU_per_cu:1,waves_per_cu:1,fd_per_cu:1,ALU_pipe_len:1},this.globals.setText("    mov r4.w, lane_id\n    utof r4.xyzw, r4.wwww\n    mov r4.z, wave_id\n    utof r4.z, r4.z\n    add.f32 r4.xyzw, r4.xyzw, f4(0.0 0.0 0.0 1.0)\n    lt.f32 r4.xy, r4.ww, f2(16.0 8.0)\n    utof r4.xy, r4.xy\n    br_push r4.x, LB_1, LB_2\n    mov r0.x, f(666.0)\n    br_push r4.y, LB_0_1, LB_0_2\n    mov r0.y, f(666.0)\n    pop_mask\nLB_0_1:\n    mov r0.y, f(777.0)\n    pop_mask\nLB_0_2:\n    pop_mask\nLB_1:\n    mov r0.x, f(777.0)\n\n    ; push the current wave mask\n    push_mask LOOP_END\nLOOP_PROLOG:\n    lt.f32 r4.x, r4.w, f(32.0)\n    add.f32 r4.w, r4.w, f(1.0)\n    ; Setting current lane mask\n    ; If all lanes are disabled pop_mask is invoked\n    ; If mask stack is empty then wave is retired\n    mask_nz r4.x\nLOOP_BEGIN:\n    jmp LOOP_PROLOG\nLOOP_END:\n    pop_mask\n    \n    \nLB_2:\n    mov r4.y, lane_id\n    utof r4.y, r4.y\n    ret"),this.globals.resetGPU()}},{key:"timer",value:function(){if(this.globals.wasm&&this.globals.run)for(var e=0;e<this.globals.dispatchConfig.cycles_per_iter;e++)this.globals.wasm.guppy_clock()?(this.globals.clocks+=1,this.globals.setClocks(this.globals.clocks),this.globals.active_mask_history.push(this.globals.wasm.guppy_get_active_mask()),this.globals.alu_active_history.push(this.globals.wasm.guppy_get_valu_active()),this.globals.sampler_cache_history.push(this.globals.wasm.guppy_get_sampler_cache_metrics()),this.globals.l2_metric_history.push([this.globals.wasm.guppy_get_gpu_metric("L2 hit"),this.globals.wasm.guppy_get_gpu_metric("L2 miss"),this.globals.wasm.guppy_get_gpu_metric("L2 evict")]),this.globals.updateMemory(),this.globals.dispatchConfig["update graph"]&&this.globals.updateCanvas()):this.globals.run=!1}},{key:"componentDidMount",value:function(){var e=this;this.globals={},this.globals.dispatchConfig={group_size:1,groups_count:1,cycles_per_iter:1,"update graph":!0},this.globals.gpuConfig={DRAM_latency:1,DRAM_bandwidth:1,L1_size:0,L1_latency:0,L2_size:1,L2_latency:1,sampler_cache_size:1,sampler_latency:1,VGPRF_per_pe:1,wave_size:1,CU_count:1,ALU_per_cu:1,waves_per_cu:1,fd_per_cu:1,ALU_pipe_len:1},this.globals.wasm=null,this.globals.clocks=0,this.globals.setupBranch_1=this.setupBranch_1,this.globals.setupBranch_2=this.setupBranch_2,this.globals.setupBranch_3=this.setupBranch_3,this.globals.setupBranch_4=this.setupBranch_4,this.globals.setupBranch_5=this.setupBranch_5,this.globals.setupBranch_6=this.setupBranch_6,this.globals.setupRaymarching=this.setupRaymarching,this.globals.r_images=[],this.globals.active_mask_history=null,this.globals.sampler_cache_history=null,this.globals.l2_metric_history=null,this.globals.alu_active_history=null,this.intervalId=setInterval(this.timer.bind(this),1);var t={content:[{type:"row",content:[{type:"column",content:[{type:"react-component",component:"TextEditor",title:"TextEditor",props:{globals:function(){return e.globals}}},{type:"stack",content:[{type:"react-component",component:"Bindings",title:"Bindings",props:{globals:function(){return e.globals}}},{type:"react-component",component:"Parameters",title:"Parameters",props:{globals:function(){return e.globals}}}]}]},{type:"stack",content:[{type:"react-component",component:"Graphs",title:"Graphs",props:{globals:function(){return e.globals}}},{type:"react-component",component:"Readme",title:"Readme",props:{globals:function(){return e.globals}}}]}]}]},n=new h.a(t,this.layout);this.layout=n;var a=this.globals;this.globals.resetGPU=function(){a.run=!1,a.wasm.guppy_create_gpu_state(JSON.stringify(a.gpuConfig)),a.wasm.guppy_init_framebuffer(256,256),a.active_mask_history=[],a.alu_active_history=[],a.sampler_cache_history=[],a.l2_metric_history=[],a.clocks=0,a.updateMemory&&a.updateMemory(),a.updateParameters&&a.updateParameters(),a.updateCanvas&&a.updateCanvas()},b.then(function(t){n.updateSize(),e.globals.wasm=t,e.setupBranch_1()}),n.registerComponent("Graphs",C),n.registerComponent("TextEditor",v),n.registerComponent("Parameters",w),n.registerComponent("Bindings",k),n.registerComponent("Readme",z),n.init(),window.React=u.a,window.ReactDOM=g.a,window.addEventListener("resize",function(){n.updateSize()})}},{key:"render",value:function(){var e=this;return u.a.createElement("div",{className:"goldenLayout",ref:function(t){return e.layout=t}})}}]),t}(u.a.Component);n(113);g.a.render(u.a.createElement(O,null),document.getElementById("root"))}},[[114,1,2]]]);
//# sourceMappingURL=main.cdc983ab.chunk.js.map